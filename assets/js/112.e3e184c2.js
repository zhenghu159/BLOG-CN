(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{465:function(t,s,a){"use strict";a.r(s);var i=a(1),e=Object(i.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("题目: WGCNA：用于加权相关网络分析的 R 包"),a("br"),t._v("\nDOI: "),a("a",{attrs:{href:"https://doi.org/10.1186/1471-2105-9-559",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://doi.org/10.1186/1471-2105-9-559"),a("OutboundLink")],1),a("br"),t._v("\nCite: Langfelder P, Horvath S. WGCNA: an R package for weighted correlation network analysis. "),a("em",[t._v("BMC Bioinformatics")]),t._v(". 2008 Dec 29;9:559.")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("相关阅读")]),t._v(" "),a("p",[t._v("微信公众号："),a("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzkwMjM0MzA5MA==&mid=2247483944&idx=1&sn=d0835f883d930d2c15260df14ef7ecf4&chksm=c0a7b2f5f7d03be396d981ff9bb383999721e4135b1bba5982d8d41a1d09c5abba54de19aa45&token=549238884&lang=zh_CN#rd",target:"_blank",rel:"noopener noreferrer"}},[t._v("文献阅读：WGCNA：用于加权相关网络分析的 R 包"),a("OutboundLink")],1),t._v(" "),a("br"),t._v(" "),a("br"),t._v("\n站内文章：")]),t._v(" "),a("ol",[a("li",[a("RouterLink",{attrs:{to:"/pages/ffdcc0/"}},[t._v("文献阅读 --- WGCNA：an R package for weighted correlation network analysis")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/pages/9ffdf7/"}},[t._v("WGCNA：an R package for weighted correlation network analysis")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/pages/25c02b/"}},[t._v("文献阅读 --- Single-nucleus chromatin accessibility and transcriptomic characterization of Alzheimer's disease")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/pages/a24249/"}},[t._v("文献阅读 --- hdWGCNA identifies co-expression networks in high-dimensional transcriptomics data")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/pages/649303/"}},[t._v("hdWGCNA：high dimensional WGCNA")])],1)])]),t._v(" "),a("p",[a("strong",[t._v("作者介绍：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("Steve Horvath")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"https://i1.rgstatic.net/ii/profile.image/326547245420545-1454866338566_Q128/Steve-Horvath.jpg",width:"200"}})])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("University of California Los Angeles(UCLA)")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"mailto:shorvath@mednet.ucla.edu"}},[t._v("shorvath@mednet.ucla.edu")])])])])]),t._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[t._v("#")]),t._v(" Abstract")]),t._v(" "),a("p",[a("strong",[t._v("Background:")]),t._v(" 相关网络正越来越多地应用于生物信息学的应用。例如，加权基因共表达网络分析是一种描述微阵列样本间基因间相关模式的系统生物学方法。加权相关网络分析（WGCNA）可用于寻找高度相关基因的聚类（模块），用于使用模块特征基因或模块内枢纽基因总结聚类，用于模块之间和外部样本性状（使用特征基因网络方法），以及计算模块成员度量。相关网络有助于基于网络的基因筛选方法，可用于识别候选生物标志物或治疗靶点。这些方法已成功地应用于各种生物环境中，如癌症、小鼠遗传学、酵母遗传学和脑成像数据的分析。虽然相关网络方法的部分已经在单独的出版物中描述过，但需要提供一个用户友好、全面和一致的软件实现和附带的教程。")]),t._v(" "),a("p",[a("strong",[t._v("Results:")]),t._v(" WGCNA R软件包是一个R函数的综合集合，用于执行加权相关网络分析的各个方面。该软件包包括网络构建、模块检测、基因选择、拓扑属性计算、数据模拟、可视化和与外部软件接口的功能。除了R软件包之外，我们还提供了R软件教程。虽然该方法的开发是由基因表达数据驱动的，但潜在的数据挖掘方法可以应用于各种不同的设置。")]),t._v(" "),a("p",[a("strong",[t._v("Conclusion:")]),t._v(" WGCNA软件包提供了用于加权相关网络分析的R函数，例如，基因表达数据的共表达网络分析。R包连同它的源代码和其他材料可以在以下网站上免费获得：\nhttps://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/index.html")]),t._v(" "),a("h2",{attrs:{id:"wgcna-算法原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wgcna-算法原理"}},[t._v("#")]),t._v(" WGCNA 算法原理")]),t._v(" "),a("h3",{attrs:{id:"网络图概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络图概念"}},[t._v("#")]),t._v(" 网络图概念")]),t._v(" "),a("p",[t._v("在传统的网络图里面，一般分为非权重网络和权重网络。")]),t._v(" "),a("p",[t._v("对于"),a("code",[t._v("非权重网络")]),t._v("：")]),t._v(" "),a("p",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("=")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[t._v("{")]),a("mtable",[a("mtr",[a("mtd",[a("mrow",[a("mn",[t._v("1")]),a("mo",{attrs:{separator:"true"}},[t._v(",")])],1)],1),a("mtd",[a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("f")]),a("msub",[a("mi",[t._v("s")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("⩾")]),a("mi",[t._v("τ")])],1)],1)],1),a("mtr",[a("mtd",[a("mrow",[a("mn",[t._v("0")]),a("mo",{attrs:{separator:"true"}},[t._v(",")])],1)],1),a("mtd",[a("mrow",[a("mi",[t._v("o")]),a("mi",[t._v("t")]),a("mi",[t._v("h")]),a("mi",[t._v("e")]),a("mi",[t._v("r")]),a("mi",[t._v("w")]),a("mi",[t._v("i")]),a("mi",[t._v("s")]),a("mi",[t._v("e")])],1)],1)],1)],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("a_{ij} = \\begin{cases} 1, &if s_{ij} \\geqslant \\tau \\\\ 0, &otherwise \\end{cases}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"3.0000299999999998em","vertical-align":"-1.25003em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"minner textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[a("span",{staticClass:"delimsizing size4"},[t._v("{")])]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mtable"},[a("span",{staticClass:"col-align-l"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.6819999999999999em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[t._v("1")]),a("span",{staticClass:"mpunct"},[t._v(",")])])]),a("span",{staticStyle:{top:"0.7579999999999999em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[t._v("0")]),a("span",{staticClass:"mpunct"},[t._v(",")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"arraycolsep",staticStyle:{width:"1em"}}),a("span",{staticClass:"col-align-l"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.6819999999999999em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel amsrm"},[t._v("⩾")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[t._v("τ")])])]),a("span",{staticStyle:{top:"0.7579999999999999em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit"},[t._v("t")]),a("span",{staticClass:"mord mathit"},[t._v("h")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("s")]),a("span",{staticClass:"mord mathit"},[t._v("e")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])]),t._v("，其中 τ 称为"),a("code",[t._v("硬阈值(Hard Threshold)")]),t._v("。")]),t._v(" "),a("p",[t._v("非权重网络示意图如下：")]),t._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://ZhengTiger.github.io/picx-images-hosting/02-文献阅读-04-生物信息学/20081228_WGCNA/Fig1.75eyfdx6vt00.webp",width:"200px"}})]),t._v(" "),a("p",[t._v("非权重网络的特点是只能表示两个点之间是否有关系，规定阈值后，大于阈值即为有关系，小于阈值即为无关系（用 1 表示有关系；用 0 表示无关系）。")]),t._v(" "),a("p",[t._v("硬阈值会导致信息缺失。比如两个 gene 的相关性为 0.79，如果硬阈值为 0.8，那么这两个 gene 之间的连接就会被忽略。")]),t._v(" "),a("p",[t._v("对于"),a("code",[t._v("权重网络")]),t._v("：")]),t._v(" "),a("p",[t._v("权重网络示意图如下：")]),t._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://ZhengTiger.github.io/picx-images-hosting/02-文献阅读-04-生物信息学/20081228_WGCNA/Fig2.4az32t974240.webp",width:"200px"}})]),t._v(" "),a("p",[t._v("权重网络的特点是不仅能够表示两个点之间是否有关系，还能表示它们关系的强弱。")]),t._v(" "),a("h3",{attrs:{id:"无标度网络-scale-free-network"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#无标度网络-scale-free-network"}},[t._v("#")]),t._v(" 无标度网络（Scale-free Network）")]),t._v(" "),a("p",[t._v("无标度网络和随机网络示意图：")]),t._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://ZhengTiger.github.io/picx-images-hosting/02-文献阅读-04-生物信息学/20081228_WGCNA/Fig3.3q84yacy9q60.webp",width:"500px"}})]),t._v(" "),a("p",[t._v("如果各个节点之间随机连接的网络，我们称为"),a("code",[t._v("随机网络")]),t._v("，随机网络里面，连接数与节点数一般呈正态分布。")]),t._v(" "),a("p",[t._v("而有些网络，各个节点之间不是随机连接的，比如像基因网络，可能少数几个 gene 节点会连接特别多的基因，这些 gene 我们一般叫做 hub gene，而其他大多数节点之间的连接很少。这样的网络就叫做"),a("code",[t._v("无标度网络")]),t._v("，无标度网络有两个特点:")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("鲁棒性:")]),t._v(" 由于hub节点的存在，无标度网络对随机故障容错能力强。因为如果错误随机发生，hub节点数目很少，几乎不会受到影响，并且删减掉其他节点对网络结构影响很小。")]),t._v(" "),a("li",[a("strong",[t._v("脆弱性:")]),t._v(" 如果蓄意攻击hub节点，则网络结构很容易被破坏，变得离散破碎。")])]),t._v(" "),a("p",[t._v("无标度网络的连接数和对应连接数的节点数服从幂律分布，连接数多的节点数很少，连接数少的节点数特别多")]),t._v(" "),a("p",[a("code",[t._v("幂律分布(power law)")]),t._v(": "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("P")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("P(k)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("~"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("k")]),a("mrow",[a("mo",[t._v("−")]),a("mi",[t._v("γ")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k^{-\\gamma}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.771331em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.771331em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[t._v("−")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("k")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])])]),t._v(":连接数，"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("P")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("P(k)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v(": 连接数为k的节点概率，"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("γ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\gamma")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")])])])]),t._v(": 幂指数")]),t._v(" "),a("h3",{attrs:{id:"构建基因共表达网络原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建基因共表达网络原理"}},[t._v("#")]),t._v(" 构建基因共表达网络原理")]),t._v(" "),a("h4",{attrs:{id:"_1-建立相关性矩阵"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-建立相关性矩阵"}},[t._v("#")]),t._v(" 1. 建立相关性矩阵")]),t._v(" "),a("p",[t._v("相关性值： "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("S")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("=")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("∣")]),a("mi",[t._v("c")]),a("mi",[t._v("o")]),a("mi",[t._v("r")]),a("mo",[t._v("(")]),a("msub",[a("mi",[t._v("x")]),a("mi",[t._v("i")])],1),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("msub",[a("mi",[t._v("x")]),a("mi",[t._v("j")])],1),a("mo",[t._v(")")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("∣")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S_{ij}=|cor(x_i,x_j)|")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.036108em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.05764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord mathrm"},[t._v("∣")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord mathrm"},[t._v("∣")])])])]),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("x")]),a("mi",[t._v("i")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("x_i")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.58056em","vertical-align":"-0.15em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("、"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("x")]),a("mi",[t._v("j")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("x_j")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.716668em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 表示任意的两个基因表达量的向量，向量长度为样本数目"),a("br"),t._v("\n计算后得到下面这个基因两两之间得相关性矩阵:\n")]),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://ZhengTiger.github.io/picx-images-hosting/02-文献阅读-04-生物信息学/20081228_WGCNA/Fig4.1w8oyqd8olgg.webp",width:"800px"}})]),a("p"),t._v(" "),a("h4",{attrs:{id:"_2-建立邻接矩阵"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-建立邻接矩阵"}},[t._v("#")]),t._v(" 2. 建立邻接矩阵")]),t._v(" "),a("p",[t._v("邻接值： "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("=")]),a("msubsup",[a("mi",[t._v("S")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1),a("mi",[t._v("β")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("a_{ij}=S_{ij}^\\beta")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.9670159999999999em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.379988em","vertical-align":"-0.412972em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.276864em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticStyle:{top:"-0.480908em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" "),a("br"),t._v("\n这里的关键是如何确定最佳的软阈值"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("β")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\beta")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")])])])]),t._v("？"),a("br"),t._v("\n利用无标度网络幂律分布的特点，我们将公式两边取log，就可以得到这样一个线性函数："),a("br"),t._v(" "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("P")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("P(k)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("~"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("k")]),a("mrow",[a("mo",[t._v("−")]),a("mi",[t._v("γ")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k^{-\\gamma}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.771331em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.771331em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[t._v("−")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("  →  "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("l")]),a("mi",[t._v("o")]),a("mi",[t._v("g")]),a("mo",[t._v("(")]),a("mi",[t._v("P")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")]),a("mo",[t._v(")")]),a("mo",[t._v("=")]),a("mo",[t._v("−")]),a("mi",[t._v("γ")]),a("mi",[t._v("l")]),a("mi",[t._v("o")]),a("mi",[t._v("g")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("log(P(k))=-\\gamma log(k)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord"},[t._v("−")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("P")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("P(k)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v(": 连接度为k的节点概率，连接度值："),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("k")]),a("mi",[t._v("i")])],1),a("mo",[t._v("=")]),a("msubsup",[a("mo",[t._v("∑")]),a("mrow",[a("mi",[t._v("i")]),a("mo",[t._v("=")]),a("mn",[t._v("1")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("i")]),a("mo",[t._v("≠")]),a("mi",[t._v("j")])],1),a("mi",[t._v("n")])],1),a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k_i=\\sum_{i=1, i \\neq j}^n a_{ij}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.20051em","vertical-align":"-0.45050999999999997em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03148em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mop"},[a("span",{staticClass:"op-symbol small-op mop",staticStyle:{top:"-0.0000050000000000050004em"}},[t._v("∑")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.30001em","margin-left":"0em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord mathrm"},[t._v("1")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mrel"},[t._v("≠")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticStyle:{top:"-0.364em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathit"},[t._v("n")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" "),a("br"),t._v("\n在 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("β")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\beta")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")])])])]),t._v(" 值给定的情况下，"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("l")]),a("mi",[t._v("o")]),a("mi",[t._v("g")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("log(k)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v(" 和 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("l")]),a("mi",[t._v("o")]),a("mi",[t._v("g")]),a("mo",[t._v("(")]),a("mi",[t._v("P")]),a("mo",[t._v("(")]),a("mi",[t._v("k")]),a("mo",[t._v(")")]),a("mo",[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("log(P(k))")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v(" 都是可以求得的，因此我们只需要对上面这个式子进行线性回归，求得每个 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("β")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\beta")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")])])])]),t._v(" 值下对应的 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("R")]),a("mn",[t._v("2")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("R^2")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.00773em"}},[t._v("R")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[t._v("2")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("，然后选择 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("R")]),a("mn",[t._v("2")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("R^2")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.00773em"}},[t._v("R")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[t._v("2")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 和平均连接度尽可能大的 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("β")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\beta")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")])])])]),t._v(" 值，"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("R")]),a("mn",[t._v("2")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("R^2")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.00773em"}},[t._v("R")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[t._v("2")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 一般要大于0.8。"),a("br"),t._v("\n下面这两个图是 WGCNA 分析确定软阈值时会用到的图，这里 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("R")]),a("mn",[t._v("2")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("R^2")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.00773em"}},[t._v("R")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[t._v("2")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 卡的是 0.9，一般会选择 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("R")]),a("mn",[t._v("2")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("R^2")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.00773em"}},[t._v("R")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[t._v("2")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 第一次到达 0.9 时对应的软阈值，这里就是6。"),a("br")]),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://ZhengTiger.github.io/picx-images-hosting/02-文献阅读-04-生物信息学/20081228_WGCNA/Fig5.43pgsrrg6lk0.webp",width:"800px"}})]),a("p"),t._v(" "),a("p",[t._v("依据上面 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("S")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")])])])]),t._v(" 矩阵，代入 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("β")]),a("mo",[t._v("=")]),a("mn",[t._v("6")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\beta=6")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord mathrm"},[t._v("6")])])])]),t._v(" 计算 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("=")]),a("msubsup",[a("mi",[t._v("S")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1),a("mi",[t._v("β")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("a_{ij}=S_{ij}^\\beta")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.9670159999999999em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.379988em","vertical-align":"-0.412972em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.276864em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticStyle:{top:"-0.480908em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 可得到下面这个邻接矩阵：\n")]),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://ZhengTiger.github.io/picx-images-hosting/02-文献阅读-04-生物信息学/20081228_WGCNA/Fig6.3o8ul49xj3s0.webp",width:"800px"}})]),a("p"),t._v(" "),a("h4",{attrs:{id:"_3-建立tom矩阵"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-建立tom矩阵"}},[t._v("#")]),t._v(" 3. 建立TOM矩阵")]),t._v(" "),a("p",[t._v("TOM值： "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("O")]),a("msub",[a("mi",[t._v("M")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("msub",[a("mo",[t._v("∑")]),a("mrow",[a("mi",[t._v("u")]),a("mo",[t._v("≠")]),a("mi",[t._v("i")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("(")]),a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("u")])],1)],1),a("mo",[t._v("∗")]),a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("u")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v(")")]),a("mo",[t._v("−")]),a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1)],1),a("mrow",[a("mi",[t._v("m")]),a("mi",[t._v("i")]),a("mi",[t._v("n")]),a("mo",[t._v("{")]),a("msub",[a("mo",[t._v("∑")]),a("mrow",[a("mi",[t._v("u")]),a("mo",[t._v("≠")]),a("mi",[t._v("i")])],1)],1),a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("u")])],1)],1),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("msub",[a("mo",[t._v("∑")]),a("mrow",[a("mi",[t._v("u")]),a("mo",[t._v("≠")]),a("mi",[t._v("j")])],1)],1),a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("u")]),a("mi",[t._v("j")])],1)],1),a("mo",[t._v("}")]),a("mo",[t._v("+")]),a("mn",[t._v("1")]),a("mo",[t._v("−")]),a("msub",[a("mi",[t._v("a")]),a("mrow",[a("mi",[t._v("i")]),a("mi",[t._v("j")])],1)],1)],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("TOM_{ij} = \\frac{\\sum_{u \\neq i,j}(a_{iu}*a_{uj})-a_{ij}}{min\\lbrace \\sum_{u \\neq i}a_{iu},\\sum_{u \\neq j}a_{uj} \\rbrace +1 -a_{ij}}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.152507em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.815014em","vertical-align":"-0.662507em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("O")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("M")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10903em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord reset-textstyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.345em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("m")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("n")]),a("span",{staticClass:"mopen"},[t._v("{")]),a("span",{staticClass:"mop"},[a("span",{staticClass:"op-symbol small-op mop",staticStyle:{top:"0.074995em"}},[t._v("∑")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.30001em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("u")]),a("span",{staticClass:"mrel"},[t._v("≠")]),a("span",{staticClass:"mord mathit"},[t._v("i")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("u")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mop"},[a("span",{staticClass:"op-symbol small-op mop",staticStyle:{top:"0.074995em"}},[t._v("∑")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.30001em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("u")]),a("span",{staticClass:"mrel"},[t._v("≠")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15000000000000002em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("u")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mclose"},[t._v("}")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathrm"},[t._v("1")]),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15000000000000002em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.627507em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mop"},[a("span",{staticClass:"op-symbol small-op mop",staticStyle:{top:"0.074995em"}},[t._v("∑")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.30001em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("u")]),a("span",{staticClass:"mrel"},[t._v("≠")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("u")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mbin"},[t._v("∗")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15000000000000002em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("u")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15000000000000002em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])]),t._v(" "),a("p",[t._v("如果直接使用邻接矩阵还是不够的，因为就算两个gene之间的连接度很低，他们仍然可能属于同一个模块。这里可以用社交网络的例子解释：假设A、B同属于同一个公司，且A与B不认识，互相无关联，但A与B都各有该公司的很多共同好友，则可以认为A与B的社交网络重叠性强，因此认为A与B在同一模块（所属的公司）。")]),t._v(" "),a("p",[t._v("公式中引入第三个基因u，即若第 i 个基因和第 j 个基因有连通性，而第 u 个基因分别于第 i 个基因和第 j 个基因都有连通性，那么我们认为第 i 个基因和第 j 个基因的连通性通过第 u 个基因的得到了间接加强")]),t._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://ZhengTiger.github.io/picx-images-hosting/02-文献阅读-04-生物信息学/20081228_WGCNA/Fig7.4a2aowdh5xo0.webp",width:"500px"}})]),t._v(" "),a("p",[t._v("后续会使用这个TOM矩阵来进行聚类，识别gene模块，进行一些下游的分析。")]),t._v(" "),a("h3",{attrs:{id:"一些术语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些术语"}},[t._v("#")]),t._v(" 一些术语")]),t._v(" "),a("p",[a("code",[t._v("Module eigengene(ME)")]),t._v("：表示某个模块的第一主成分。它可以被认为是一个模块中的基因表达谱的一个代表。"),a("br"),t._v(" "),a("code",[t._v("GS(Gene Signicance)")]),t._v("：表示某一个基因与性状的相关性。"),a("br"),t._v(" "),a("code",[t._v("MM(Module Membership)")]),t._v("：表示某一个基因与模块之间的相关性，即某基因与该模块特征向量的相关性。")]),t._v(" "),a("h2",{attrs:{id:"figure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#figure"}},[t._v("#")]),t._v(" Figure")]),t._v(" "),a("h3",{attrs:{id:"fig1-overview-of-wgcna-methodology"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fig1-overview-of-wgcna-methodology"}},[t._v("#")]),t._v(" Fig1. Overview of WGCNA methodology")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://media.springernature.com/full/springer-static/image/art%3A10.1186%2F1471-2105-9-559/MediaObjects/12859_2008_Article_2544_Fig1_HTML.jpg?as=webp",alt:"Fig1"}})]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Fig1. WGCNA 方法概述")]),t._v(" "),a("p",[t._v("加权基因共表达网络分析的主要步骤：")]),t._v(" "),a("ol",[a("li",[t._v("构建基因共表达网络")]),t._v(" "),a("li",[t._v("划分模块")]),t._v(" "),a("li",[t._v("模块与性状关联分析")]),t._v(" "),a("li",[t._v("模块之间关联分析")]),t._v(" "),a("li",[t._v("模块中核心基因鉴定")])])]),t._v(" "),a("h3",{attrs:{id:"fig2-network-visualization-plots"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fig2-network-visualization-plots"}},[t._v("#")]),t._v(" Fig2. Network visualization plots")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://media.springernature.com/full/springer-static/image/art%3A10.1186%2F1471-2105-9-559/MediaObjects/12859_2008_Article_2544_Fig2_HTML.jpg?as=webp",alt:"Fig2"}})]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Fig2. 网络可视化图")]),t._v(" "),a("p",[a("strong",[t._v("A.")]),t._v(" log(k) 和 log(P(k)) 服从负的线性回归，这称为近似无标度拓扑。"),a("br"),t._v(" "),a("strong",[t._v("B.")]),t._v(" 通过 multi-dimensional scaling plot 提供了模块结构的替代可视化。"),a("br"),t._v(" "),a("strong",[t._v("C.")]),t._v(" 基因网络的热图，以及相应的层次聚类树状图和得到的模块。")])]),t._v(" "),a("h3",{attrs:{id:"fig3-module-and-eigengene-network-plots"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fig3-module-and-eigengene-network-plots"}},[t._v("#")]),t._v(" Fig3. Module and eigengene network plots")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://media.springernature.com/full/springer-static/image/art%3A10.1186%2F1471-2105-9-559/MediaObjects/12859_2008_Article_2544_Fig3_HTML.jpg?as=webp",alt:"Fig3"}})]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Fig3. 模块和特征基因网络图")]),t._v(" "),a("p",[a("strong",[t._v("A.")]),t._v(" 每个模块的平均 gene significance(GS)。"),a("br"),t._v(" "),a("strong",[t._v("B.")]),t._v(" module membership(MM) 与 gene significance(GS) 的散点图，每一个点代表一个 gene。一般在与性状相关的模块中，MM 和 GS 会呈正相关。"),a("br"),t._v(" "),a("strong",[t._v("C.")]),t._v(" module eigengenes(ME) 的层次聚类树状图。"),a("br"),t._v(" "),a("strong",[t._v("D.")]),t._v(" 不同模块之间 module eigengenes(ME) 的相关性。")])]),t._v(" "),a("h3",{attrs:{id:"fig4-wgcna-analysis-of-liver-expression-data-in-female-mice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fig4-wgcna-analysis-of-liver-expression-data-in-female-mice"}},[t._v("#")]),t._v(" Fig4. WGCNA analysis of liver expression data in female mice")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://media.springernature.com/full/springer-static/image/art%3A10.1186%2F1471-2105-9-559/MediaObjects/12859_2008_Article_2544_Fig4_HTML.jpg?as=webp",alt:"Fig4"}})]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Fig4. 雌性小鼠肝脏表达数据的示例 WGCNA 分析")]),t._v(" "),a("p",[a("strong",[t._v("A.")]),t._v(" 通过 average linkage hierarchical clustering 得到的基因树状图。树状图下面的颜色条显示了由 Dynamic Tree Cut 所确定的模块分配。"),a("br"),t._v(" "),a("strong",[t._v("B.")]),t._v(" TOM 热图，每一行和每一列对应一个基因，同一个模块中 TOM 值较高。"),a("br"),t._v(" "),a("strong",[t._v("C.")]),t._v(" module eigengenes(ME) 的层次聚类树状图。"),a("br"),t._v(" "),a("strong",[t._v("D.")]),t._v(" 不同模块之间 module eigengenes(ME) 的相关性。"),a("br"),t._v(" "),a("strong",[t._v("E.")]),t._v(" module membership(MM) 与 gene significance(GS) 的散点图。GS 和 MM 表现出非常显著的相关性，这意味着棕色模块的 hub genes 也往往与体重高度相关。"),a("br"),t._v(" "),a("strong",[t._v("F.")]),t._v(" 棕色模块中 30 个高度相连的基因的网络。在这个网络中，我们只显示 TOM 值高于 0.08 的连接。")])]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("参考资料")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/dcae5fb86559",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.jianshu.com/p/dcae5fb86559"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);